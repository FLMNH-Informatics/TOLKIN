var DataModel=Class.create({attributes:{},klass:null,metadata:null,initialize:function(b,a){if(a){Object.extend(this,a)}this.id=b},destroy:function(a){new DestroyJob(this._objectPath(),this,a).run()},loadAttributes:function(a){var b=this;new Ajax.Request(this._objectPath(),{method:"get",onSuccess:function(c){Object.extend(b,b._processAttributes(Object.values(c.responseText.evalJSON()).first()));if(a.callback){a.callback()}},onFailure:function(){Notifier.error("failed to load "+this.klass+"data")}})},select:function(){GlobalCart.setCurrentSelection(this.klass,this.id,this.klass+": "+this.name);return this},update:function(){InternalNotifier.notify("update",this.klass,this.id)},_loadHasManyRelation:function(d,c){c=c||{};var a=["limit","order","offset","only"].inject([],function(f,e){if(c[e]){f.push(e+"="+c[e])}return f},this);a=(a.size()>0)?"?"+a.join("&"):"";var b=this;new Ajax.Request(this._objectPath()+"/"+d+a,{method:"get",onSuccess:function(e){b[d]=e.responseText.evalJSON().map(function(f){return Object.values(f).first()});if(c.callback){c.callback()}},onFailure:function(){Notifier.error("failed to load "+d+" data")}})},_processAttributes:function(a){return a}});